{% extends "base.html" %}

{% block title %}Order Confirmation - Thank You!{% endblock %}

{% block content %}
<div class="container-fluid py-4" style="background: linear-gradient(135deg, #0a2c5c, #499aa8); min-height: 100vh;">
    
    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="row mb-4">
                <div class="col-lg-8 mx-auto">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'success' if category == 'success' else 'danger' if category == 'error' else 'info' }} text-center" 
                             style="background: rgba(25, 135, 84, 0.3); border: 1px solid rgba(25, 135, 84, 0.5); color: white;">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    {% endwith %}
    
    <!-- Success Header -->
    <div class="row mb-5">
        <div class="col-lg-12">
            <div class="text-center mb-4">
                <div class="mb-4">
                    <i class="fas fa-check-circle fa-5x text-success mb-3" style="color: #28a745 !important;"></i>
                </div>
                <h1 class="display-4 text-white mb-3">ðŸŽ‰ Order Placed Successfully! ðŸŽ‰</h1>
                <p class="lead text-light mb-4">
                    Thank you for your order of dengue prevention products
                </p>
                <div class="alert alert-success d-inline-block" style="background: rgba(25, 135, 84, 0.5); border: 1px solid rgba(25, 135, 84, 0.8); color: white !important;">
                    <h5 class="text-light mb-2" style="color: white !important;">
                        <i class="fas fa-receipt me-2"></i>Order Number: <strong>{{ order.order_number }}</strong>
                    </h5>
                    <p class="text-light mb-0" style="color: white !important;">Please keep this number for your records</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details -->
    <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
            <div class="card" style="background: linear-gradient(135deg, rgba(16, 90, 165, 0.8), rgba(73, 154, 168, 0.8)); border: 1px solid rgba(73, 154, 168, 0.5); backdrop-filter: blur(10px);">
                <div class="card-header">
                    <h4 class="text-light mb-0">
                        <i class="fas fa-box me-2"></i>Order Details
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h6 class="text-light">Order Information</h6>
                            <ul class="list-unstyled text-light">
                                <li><strong>Order Number:</strong> {{ order.order_number }}</li>
                                <li><strong>Order Date:</strong> {{ order.ordered_at.strftime('%B %d, %Y at %I:%M %p') }}</li>
                                <li><strong>Total Amount:</strong> â‚¹{{ "%.0f"|format(order.total_amount) }}</li>
                                <li><strong>Payment Method:</strong> Cash on Delivery</li>
                                <li><strong>Status:</strong> 
                                    <span class="badge bg-warning">{{ order.status.title() }}</span>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-light">Delivery Information</h6>
                            <ul class="list-unstyled text-light">
                                <li><strong>Delivery Address:</strong><br>{{ order.shipping_address }}</li>
                                <li><strong>Phone:</strong> {{ order.phone_number }}</li>
                                <li><strong>Estimated Delivery:</strong> {{ order.estimated_delivery.strftime('%B %d, %Y') }}</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Order Items -->
                    <div class="mb-4">
                        <h6 class="text-light mb-3">Ordered Items</h6>
                        <div class="table-responsive">
                            <table class="table table-dark table-striped">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th>Subtotal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in order.items %}
                                    <tr>
                                        <td>{{ item.product_name }}</td>
                                        <td>â‚¹{{ "%.0f"|format(item.price) }}</td>
                                        <td>{{ item.quantity }}</td>
                                        <td>â‚¹{{ "%.0f"|format(item.price * item.quantity) }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                                <tfoot>
                                    <tr class="table-warning">
                                        <th colspan="3">Total Amount</th>
                                        <th>â‚¹{{ "%.0f"|format(order.total_amount) }}</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    {% if order.notes %}
                    <div class="mb-3">
                        <h6 class="text-light">Special Instructions</h6>
                        <p class="text-light">{{ order.notes }}</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Next Steps -->
    <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
            <div class="card" style="background: linear-gradient(135deg, rgba(40, 167, 69, 0.8), rgba(25, 135, 84, 0.8)); border: 1px solid rgba(40, 167, 69, 0.5); backdrop-filter: blur(10px);">
                <div class="card-header">
                    <h5 class="text-light mb-0">
                        <i class="fas fa-info-circle me-2"></i>What's Next?
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <i class="fas fa-phone fa-2x text-warning mb-2"></i>
                                <h6 class="text-light">Order Confirmation</h6>
                                <p class="text-light small">You will receive a confirmation call within 2 hours</p>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <i class="fas fa-truck fa-2x text-warning mb-2"></i>
                                <h6 class="text-light">Preparation & Dispatch</h6>
                                <p class="text-light small">Your order will be packed and dispatched within 24 hours</p>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <i class="fas fa-home fa-2x text-warning mb-2"></i>
                                <h6 class="text-light">Delivery</h6>
                                <p class="text-light small">Delivered to your doorstep in 2-3 business days</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Important Information -->
    <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
            <div class="card" style="background: linear-gradient(135deg, rgba(255, 193, 7, 0.8), rgba(255, 140, 0, 0.8)); border: 1px solid rgba(255, 193, 7, 0.5); backdrop-filter: blur(10px);">
                <div class="card-header">
                    <h5 class="text-dark mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>Important Information
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled text-dark mb-0">
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            <strong>Cash on Delivery:</strong> Pay when your order is delivered
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            <strong>Quality Guarantee:</strong> All products are WHO approved
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            <strong>Easy Returns:</strong> 7-day return policy for unopened items
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            <strong>Customer Support:</strong> Available for any queries or issues
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="row">
        <div class="col-lg-8 mx-auto text-center">
            <div class="d-flex flex-wrap gap-3 justify-content-center">
                <a href="{{ url_for('my_orders') }}" class="btn btn-info btn-lg">
                    <i class="fas fa-list me-2"></i>View All Orders
                </a>
                <a href="{{ url_for('marketplace') }}" class="btn btn-warning btn-lg">
                    <i class="fas fa-store me-2"></i>Continue Shopping
                </a>
                <a href="{{ url_for('dashboard') }}" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-home me-2"></i>Go to Dashboard
                </a>
            </div>
        </div>
    </div>

    <!-- Download Order Summary -->
    <div class="row mt-4">
        <div class="col-lg-8 mx-auto text-center">
            <p class="text-light">
                <i class="fas fa-download me-2"></i>
                <a href="#" class="text-warning" onclick="window.print()">Download Order Summary</a>
            </p>
        </div>
    </div>
</div>

<script>
// Auto-refresh cart count
document.addEventListener('DOMContentLoaded', function() {
    if (typeof updateCartCount === 'function') {
        updateCartCount();
    }
});
</script>
{% endblock %}